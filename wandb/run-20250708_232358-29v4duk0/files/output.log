  0%|                                                                                                                           | 0/4092 [00:00<?, ?it/s]
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([133])
answer ids shape: torch.Size([26])
jacobian trajectory size: 162
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([32])
Jacobian prompt ids shape: torch.Size([505])
answer ids shape: torch.Size([17])
jacobian trajectory size: 93
  labels = torch.tensor(labels).to(model.device)
/code/users/lhu/workspace/CLLM2/train/cllm_trainer.py:58: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(dtype=torch.bfloat16):
[WARNING|logging.py:328] 2025-07-08 23:24:00,796 >> The input hidden states seems to be silently casted in float32, this might be related to the fact you have upcasted embedding or layer norm layers in float32. We will cast back the input in torch.bfloat16.
loss ar: 43.61443328857422 computed! performing backward pass...
/code/users/lhu/workspace/CLLM2/train/cllm_trainer.py:108: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(dtype=torch.bfloat16):
Traceback (most recent call last):
  File "/code/users/lhu/workspace/CLLM2/train/train_cllm.py", line 313, in <module>
    train()
  File "/code/users/lhu/workspace/CLLM2/train/train_cllm.py", line 305, in train
    trainer.train()
  File "/code/users/lhu/workspace/CLLM2/cllm2/lib/python3.10/site-packages/transformers/trainer.py", line 2207, in train
    return inner_training_loop(
  File "/code/users/lhu/workspace/CLLM2/cllm2/lib/python3.10/site-packages/transformers/trainer.py", line 2549, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
  File "/code/users/lhu/workspace/CLLM2/train/cllm_trainer.py", line 22, in training_step
    return self.consistency_training_step(model, inputs)
  File "/code/users/lhu/workspace/CLLM2/train/cllm_trainer.py", line 114, in consistency_training_step
    end_of_mask_position = torch.where(jacobian_trajectory[i][j, 1:] != jacobian_trajectory[-1][j, 1:])[0]
RuntimeError: The size of tensor a (164) must match the size of tensor b (158) at non-singleton dimension 0
[rank0]: Traceback (most recent call last):
[rank0]:   File "/code/users/lhu/workspace/CLLM2/train/train_cllm.py", line 313, in <module>
[rank0]:     train()
[rank0]:   File "/code/users/lhu/workspace/CLLM2/train/train_cllm.py", line 305, in train
[rank0]:     trainer.train()
[rank0]:   File "/code/users/lhu/workspace/CLLM2/cllm2/lib/python3.10/site-packages/transformers/trainer.py", line 2207, in train
[rank0]:     return inner_training_loop(
[rank0]:   File "/code/users/lhu/workspace/CLLM2/cllm2/lib/python3.10/site-packages/transformers/trainer.py", line 2549, in _inner_training_loop
[rank0]:     tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
[rank0]:   File "/code/users/lhu/workspace/CLLM2/train/cllm_trainer.py", line 22, in training_step
[rank0]:     return self.consistency_training_step(model, inputs)
[rank0]:   File "/code/users/lhu/workspace/CLLM2/train/cllm_trainer.py", line 114, in consistency_training_step
[rank0]:     end_of_mask_position = torch.where(jacobian_trajectory[i][j, 1:] != jacobian_trajectory[-1][j, 1:])[0]
[rank0]: RuntimeError: The size of tensor a (164) must match the size of tensor b (158) at non-singleton dimension 0
